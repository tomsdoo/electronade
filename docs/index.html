<!DOCTYPE html>
<html>
<head>
  <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
  <script src="https://unpkg.com/vue@3"></script>
  <script>
    const markdownPaths = [
      "/md/test1.md",
      "/md/test2.md"
    ];
    let pageContents = {};
    async function fetchPageContent(path){
      return fetch(path)
        .then(async response => ({
          rawPath: path,
          hashPath: path
            .replace(/index\.md$/, "")
            .replace(/\.md$/, ""),
          url: response.url,
          text: await response.text()
        }))
        .then(content => ({
          ...content,
          title: content.text.split("\n")[0].replace(/^# /, ""),
          html: marked.parse(content.text)
        }));
    }
    window.addEventListener("load", async () => {
      pageContents = Object.fromEntries(
        await Promise.all(
          markdownPaths.map(async (markdownPath) => [markdownPath, await fetchPageContent(markdownPath)])
        )
      );
      console.log(pageContents);

      const app = Vue.createApp({
        setup: () => ({
          message: "hello"
        })
      });
      app.mount("#app");
      console.log(Vue);
    });
  </script>
  <style>
    [v-cloak] {
      position: relative;
    }
    [v-cloak]::before {
      position: absolute;
      z-index: 1;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
    }
  </style>
</head>
<body>
  <main id="app" v-cloak>
    {{ message }}
  </main>
</body>
</html>
